<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Five Forks Fire Weather</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    body { margin: 0; font-family: sans-serif; background: #f9fafb; color: #1f2937; }
    .header { background: #3b82f6; color: white; padding: 1rem; font-size: 1.25rem; }
    .cards { display: grid; gap: 1rem; padding: 1rem; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); }
    .card { background: white; border-radius: 8px; padding: 1rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .map-wrap { height: 400px; margin: 1rem; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    footer { text-align: center; padding: 1rem; color: #6b7280; }
  </style>
</head>
<body>
  <div class="header">ðŸ”¥ Five Forks Fire Weather</div>
  <div class="cards" id="cards"></div>
  <div class="map-wrap"><div id="map" style="height:100%;"></div></div>
  <footer>Data: NOAA NWS + NASA FIRMS â€¢ Updates hourly</footer>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    const COUNTIES = [
      { name: "Amelia", lat: 37.342, lon: -77.980 },
      { name: "Nottoway", lat: 37.142, lon: -78.089 },
      { name: "Dinwiddie", lat: 37.077, lon: -77.587 },
      { name: "Prince George", lat: 37.221, lon: -77.288 },
      { name: "Brunswick", lat: 36.758, lon: -77.847 },
      { name: "Greensville", lat: 36.686, lon: -77.542 }
    ];
    async function fetchNOAA(lat, lon) {
      try {
        const meta = await fetch(`https://api.weather.gov/points/${lat},${lon}`);
        const m = await meta.json();
        const url = m.properties.forecastHourly;
        const hourly = await fetch(url);
        const h = await hourly.json();
        return h.properties.periods[0];
      } catch { return null; }
    }
    async function loadWeather() {
      const cards = document.getElementById('cards');
      cards.innerHTML = '';
      for (const c of COUNTIES) {
        const data = await fetchNOAA(c.lat, c.lon);
        const el = document.createElement('div');
        el.className = 'card';
        el.innerHTML = `
          <strong>${c.name}</strong><br>
          ${data ? `${data.temperature}Â°F Â· ${data.relativeHumidity?.value ?? 'â€“'}% RH Â· ${data.windSpeed}` : 'Weather unavailable'}<br>
          ${data?.shortForecast ?? ''}
        `;
        cards.appendChild(el);
      }
    }
    function initMap() {
      const map = L.map('map').setView([37.1, -77.6], 8);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
      }).addTo(map);
    }
    window.addEventListener('DOMContentLoaded', () => {
      initMap();
      loadWeather();
      setInterval(loadWeather, 3600000);
    });
  </script>
</body>
</html>